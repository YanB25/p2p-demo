<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="389px" preserveAspectRatio="none" style="width:743px;height:389px;" version="1.1" viewBox="0 0 743 389" width="743px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ui6uo0ehb1oz" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FEFECE" filter="url(#f1ui6uo0ehb1oz)" height="162.4883" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="324" x="6" y="112"/><rect fill="#FFFFFF" height="130" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="318" x="9" y="141.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="6" x2="330" y1="138.4883" y2="138.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="110.5" y="130.5352">SendFileMachine</text><ellipse cx="52.5" cy="161.1823" fill="#000000" filter="url(#f1ui6uo0ehb1oz)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1ui6uo0ehb1oz)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="17" y="208.1823"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="17" x2="88" y1="234.6706" y2="234.6706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="51" x="27" y="226.7174">Waiting</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="22" y="251.2721">[1,0]</text><rect fill="#FEFECE" filter="url(#f1ui6uo0ehb1oz)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="76" x="220.5" y="208.1823"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="220.5" x2="296.5" y1="234.6706" y2="234.6706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="230.5" y="226.7174">Sending</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="225.5" y="251.2721">[0,1]</text><!--link *start*SendFileMachine to Waiting--><path d="M52.5,171.2631 C52.5,179.4958 52.5,191.5845 52.5,202.936 " fill="none" id="*start*SendFileMachine-Waiting" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="52.5,208.0832,56.5,199.0832,52.5,203.0832,48.5,199.0832,52.5,208.0832" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Waiting to Sending--><path d="M88.0382,249.135 C93.7002,251.0172 99.5661,252.6409 105.25,253.6823 C148.0925,261.5314 160.3496,261.2081 203.25,253.6823 C207.2063,252.9882 211.2526,252.0345 215.2677,250.9175 " fill="none" id="Waiting-Sending" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="220.3275,249.4225,210.5629,248.1368,215.5325,250.8394,212.8299,255.8089,220.3275,249.4225" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="106.25" y="250.2506">Recv Interested</text><!--link Sending to Waiting--><path d="M220.2358,233.6823 C184.2693,233.6823 130.5927,233.6823 93.6998,233.6823 " fill="none" id="Sending-Waiting" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="88.3825,233.6823,97.3825,237.6823,93.3825,233.6823,97.3825,229.6823,88.3825,233.6823" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="97.75" y="227.2506">Recv UnInterested</text><rect fill="#FEFECE" filter="url(#f1ui6uo0ehb1oz)" height="370.4883" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="366" x="365" y="8"/><rect fill="#FFFFFF" height="338" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="360" x="368" y="37.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="365" x2="731" y1="34.4883" y2="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="492" y="26.5352">RecvFileMachine</text><ellipse cx="463" cy="57.4883" fill="#000000" filter="url(#f1ui6uo0ehb1oz)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1ui6uo0ehb1oz)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="426" y="104.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="426" x2="500" y1="130.9766" y2="130.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="436" y="123.0234">NoNeed</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="431" y="147.5781">[1,0]</text><rect fill="#FEFECE" filter="url(#f1ui6uo0ehb1oz)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="80" x="376" y="208.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="376" x2="456" y1="234.9766" y2="234.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="386" y="227.0234">Chocked</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="381" y="251.5781">[1,1]</text><rect fill="#FEFECE" filter="url(#f1ui6uo0ehb1oz)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="440.5" y="312.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="440.5" x2="513.5" y1="338.9766" y2="338.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="450.5" y="331.0234">Recving</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="445.5" y="355.5781">[0,1]</text><!--link *start*RecvFileMachine to NoNeed--><path d="M463,67.5691 C463,75.8019 463,87.8906 463,99.2421 " fill="none" id="*start*RecvFileMachine-NoNeed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="463,104.3893,467,95.3893,463,99.3893,459,95.3893,463,104.3893" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NoNeed to NoNeed--><path d="M500.0153,121.7887 C510.2097,122.1848 518,124.918 518,129.9883 C518,134.1872 512.6575,136.7832 505.0314,137.7766 " fill="none" id="NoNeed-NoNeed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="500.0153,138.1879,509.3122,141.4388,504.9986,137.7792,508.6582,133.4656,500.0153,138.1879" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NoNeed to Chocked--><path d="M425.8017,142.5989 C411.6796,149.4102 397.0667,159.3891 389,173.4883 C383.5018,183.0981 385.9556,194.0348 391.1588,203.9419 " fill="none" id="NoNeed-Chocked" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="393.7242,208.4129,392.7145,198.6159,391.2358,204.0761,385.7756,202.5974,393.7242,208.4129" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="390" y="187.0566">Bitfield &amp;&amp; have need</text><!--link Chocked to Chocked--><path d="M456.1186,224.3549 C466.3323,224.9881 474,228.1992 474,233.9883 C474,238.7824 468.7415,241.8085 461.1334,243.0667 " fill="none" id="Chocked-Chocked" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="456.1186,243.6217,465.504,246.6074,461.0883,243.0717,464.624,238.656,456.1186,243.6217" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Chocked to Recving--><path d="M430.1482,259.7403 C436.1629,270.5359 443.3185,283.1821 450,294.4883 C452.5776,298.8501 455.346,303.426 458.0923,307.9046 " fill="none" id="Chocked-Recving" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="460.8234,312.3391,459.5096,302.5782,458.2014,308.0817,452.6979,306.7735,460.8234,312.3391" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="451" y="291.0566">UnChocked</text><!--link Recving to Recving--><path d="M513.6788,328.2978 C523.7805,328.7659 531.5,331.9961 531.5,337.9883 C531.5,342.857 526.4039,345.9022 519.0746,347.1242 " fill="none" id="Recving-Recving" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="513.6788,347.6788,523.0407,350.7372,518.6526,347.1674,522.2225,342.7792,513.6788,347.6788" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="537.5" y="343.0566">Recv Piece &amp;&amp; have need</text><!--link Recving to NoNeed--><path d="M511.8476,312.288 C516.7881,306.9873 521.1504,301.0085 524,294.4883 C545.5362,245.2111 548.6263,221.2962 524,173.4883 C519.5272,164.805 512.4296,157.4729 504.6321,151.4466 " fill="none" id="Recving-NoNeed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="500.2403,148.2326,505.1408,156.7757,504.2752,151.1855,509.8654,150.3199,500.2403,148.2326" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="542" y="239.0566">No more need</text><!--
@startuml status
state SendFileMachine{
    [*] - -> Waiting
    Waiting: [1,0]
    Waiting-> Sending: Recv Interested
    Sending: [0,1]
    Sending-> Waiting: Recv UnInterested
}
state RecvFileMachine{
    [*] - -> NoNeed
    NoNeed - -> NoNeed
    NoNeed: [1,0]
    NoNeed - -> Chocked : Bitfield && have need
    Chocked: [1,1]
    Chocked - -> Chocked
    Recving: [0,1]
    Chocked - -> Recving : UnChocked
    Recving - -> Recving : Recv Piece && have need
    Recving - -> NoNeed : No more need
    
}
@enduml

PlantUML version 1.2018.03(Fri Apr 06 00:59:15 CST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 9.0.4+11
Operating System: Mac OS X
OS Version: 10.12.6
Default Encoding: UTF-8
Language: en
Country: CN
--></g></svg>