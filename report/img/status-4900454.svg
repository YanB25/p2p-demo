<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="419px" preserveAspectRatio="none" style="width:916px;height:419px;" version="1.1" viewBox="0 0 916 419" width="916px" zoomAndPan="magnify"><defs><filter height="300%" id="flfjhswlf2skd" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FEFECE" filter="url(#flfjhswlf2skd)" height="176.4883" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="455" x="6" y="120"/><rect fill="#FFFFFF" height="144" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="449" x="9" y="149.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="6" x2="461" y1="146.4883" y2="146.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="176" y="138.5352">SendFileMachine</text><ellipse cx="52.5" cy="169.8681" fill="#000000" filter="url(#flfjhswlf2skd)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#flfjhswlf2skd)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="17" y="216.8681"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="17" x2="88" y1="243.3564" y2="243.3564"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="51" x="27" y="235.4032">Waiting</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="22" y="259.9579">[1,0]</text><rect fill="#FEFECE" filter="url(#flfjhswlf2skd)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="76" x="238.5" y="216.8681"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="238.5" x2="314.5" y1="243.3564" y2="243.3564"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="248.5" y="235.4032">Sending</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="243.5" y="259.9579">[0,1]</text><!--link *start*SendFileMachine to Waiting--><path d="M52.5,179.9489 C52.5,188.1816 52.5,200.2703 52.5,211.6218 " fill="none" id="*start*SendFileMachine-Waiting" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="52.5,216.769,56.5,207.769,52.5,211.769,48.5,207.769,52.5,216.769" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Waiting to Waiting--><path d="M88.2532,234.1588 C98.2932,234.5184 106,237.2548 106,242.3681 C106,246.5226 100.9123,249.108 93.6192,250.1243 " fill="none" id="Waiting-Waiting" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="88.2532,250.5773,97.5578,253.8061,93.2355,250.1567,96.8848,245.8344,88.2532,250.5773" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Waiting to Sending--><path d="M88.0533,266.582 C96.313,271.0317 105.3134,275.0115 114.25,277.3681 C135.308,282.9209 191.146,282.7433 212.25,277.3681 C219.4509,275.534 226.7158,272.7104 233.6395,269.4454 " fill="none" id="Waiting-Sending" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="238.3734,267.1213,228.5317,267.4971,233.8852,269.3248,232.0574,274.6783,238.3734,267.1213" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="115.25" y="258.9364">Recv Interested</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="117.75" y="274.247">Send UnChoke</text><!--link Sending to Waiting--><path d="M238.3508,242.3681 C198.1321,242.3681 134.9913,242.3681 93.6684,242.3681 " fill="none" id="Sending-Waiting" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="88.4895,242.3681,97.4895,246.3681,93.4895,242.3681,97.4895,238.3681,88.4895,242.3681" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="106.75" y="220.9364">Recv UnInterested</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="159.25" y="236.247">Î›</text><!--link Sending to Sending--><path d="M314.714,234.1906 C324.8346,234.6578 332.5,237.3837 332.5,242.3681 C332.5,246.4179 327.4397,248.9767 320.1135,250.0445 " fill="none" id="Sending-Sending" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="314.714,250.5455,324.0452,253.6965,319.6926,250.0833,323.3058,245.7307,314.714,250.5455" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="338.5" y="239.9364">Recv Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="349" y="255.247">Send Piece</text><rect fill="#FEFECE" filter="url(#flfjhswlf2skd)" height="400.4883" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="408" x="496.5" y="8"/><rect fill="#FFFFFF" height="368" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="402" x="499.5" y="37.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="496.5" x2="904.5" y1="34.4883" y2="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="644.5" y="26.5352">RecvFileMachine</text><ellipse cx="602.0703" cy="57.4883" fill="#000000" filter="url(#flfjhswlf2skd)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#flfjhswlf2skd)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="565.0703" y="104.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="565.0703" x2="639.0703" y1="130.9766" y2="130.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="575.0703" y="123.0234">NoNeed</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="570.0703" y="147.5781">[1,0]</text><rect fill="#FEFECE" filter="url(#flfjhswlf2skd)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="508.5703" y="223.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="508.5703" x2="581.5703" y1="249.9766" y2="249.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="518.5703" y="242.0234">Choked</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="513.5703" y="266.5781">[1,1]</text><rect fill="#FEFECE" filter="url(#flfjhswlf2skd)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="582.5703" y="342.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="582.5703" x2="655.5703" y1="368.9766" y2="368.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="592.5703" y="361.0234">Recving</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="587.5703" y="385.5781">[0,1]</text><!--link *start*RecvFileMachine to NoNeed--><path d="M602.0703,67.5691 C602.0703,75.8019 602.0703,87.8906 602.0703,99.2421 " fill="none" id="*start*RecvFileMachine-NoNeed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="602.0703,104.3893,606.0703,95.3893,602.0703,99.3893,598.0703,95.3893,602.0703,104.3893" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NoNeed to NoNeed--><path d="M639.0856,121.7887 C649.28,122.1848 657.0703,124.918 657.0703,129.9883 C657.0703,134.1872 651.7278,136.7832 644.1017,137.7766 " fill="none" id="NoNeed-NoNeed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="639.0856,138.1879,648.3825,141.4385,644.0689,137.779,647.7284,133.4653,639.0856,138.1879" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NoNeed to Choked--><path d="M565.0056,137.9181 C545.6747,144.1379 523.6908,154.9651 512.0703,173.4883 C503.183,187.6548 509.2947,204.6276 518.5597,218.8893 " fill="none" id="NoNeed-Choked" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="521.5231,223.2222,519.744,213.5354,518.7004,219.0951,513.1407,218.0516,521.5231,223.2222" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="513.0703" y="187.0566">Recv Bitfield &amp;&amp; have need</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="557.0703" y="202.3672">Send Bitfield</text><!--link Choked to Choked--><path d="M581.7491,238.1797 C591.8508,238.7018 599.5703,242.3047 599.5703,248.9883 C599.5703,254.4187 594.4742,257.8154 587.1449,259.1783 " fill="none" id="Choked-Choked" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="581.7491,259.7969,591.1462,262.7456,586.7166,259.2273,590.2349,254.7977,581.7491,259.7969" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Choked to Recving--><path d="M554.7955,274.8047 C561.0105,289.8749 569.8177,308.9244 580.0703,324.4883 C583.1461,329.1575 586.7056,333.8329 590.3979,338.2952 " fill="none" id="Choked-Recving" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="593.8161,342.3271,591.0473,332.8754,590.5828,338.5132,584.945,338.0487,593.8161,342.3271" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="581.0703" y="306.0566">Recv UnChoked</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="588.0703" y="321.3672">Send Request</text><!--link Recving to Recving--><path d="M655.7491,357.1797 C665.8508,357.7018 673.5703,361.3047 673.5703,367.9883 C673.5703,373.4187 668.4742,376.8154 661.1449,378.1783 " fill="none" id="Recving-Recving" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="655.7491,378.7969,665.1462,381.7456,660.7166,378.2273,664.2349,373.7977,655.7491,378.7969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="679.5703" y="365.5566">Recv Piece &amp;&amp; Still have need</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="732.5703" y="380.8672">Send Request</text><!--link Recving to NoNeed--><path d="M655.6715,350.1842 C665.3754,343.5492 674.65,335.0109 680.0703,324.4883 C710.8023,264.8272 714.057,231.3572 680.0703,173.4883 C672.0279,159.7946 657.9355,150.0953 643.9214,143.386 " fill="none" id="Recving-NoNeed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="639.1807,141.2239,645.7093,148.598,643.7299,143.2987,649.0291,141.3193,639.1807,141.2239" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="705.0703" y="254.0566">No more need</text><!--
@startuml status
state SendFileMachine{
    [*] - -> Waiting
    Waiting -> Waiting
    Waiting: [1,0]
    Waiting-> Sending: Recv Interested\nSend UnChoke
    Sending: [0,1]
    Sending-> Waiting: Recv UnInterested\nÎ›
    Sending -> Sending: Recv Request\n Send Piece
}
state RecvFileMachine{
    [*] - -> NoNeed
    NoNeed - -> NoNeed
    NoNeed: [1,0]
    NoNeed - -> Choked : Recv Bitfield && have need\nSend Bitfield
    Choked: [1,1]
    Choked - -> Choked
    Recving: [0,1]
    Choked - -> Recving : Recv UnChoked\nSend Request
    Recving - -> Recving : Recv Piece && Still have need \n Send Request
    Recving - -> NoNeed : No more need
    
}
@enduml

PlantUML version 1.2018.03(Fri Apr 06 00:59:15 CST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 9.0.4+11
Operating System: Mac OS X
OS Version: 10.12.6
Default Encoding: UTF-8
Language: en
Country: CN
--></g></svg>