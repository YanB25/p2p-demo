<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="389px" preserveAspectRatio="none" style="width:779px;height:389px;" version="1.1" viewBox="0 0 779 389" width="779px" zoomAndPan="magnify"><defs><filter height="300%" id="f1acyteumssvtb" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FEFECE" filter="url(#f1acyteumssvtb)" height="162.4883" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="360" x="6" y="112"/><rect fill="#FFFFFF" height="130" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="354" x="9" y="141.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="6" x2="366" y1="138.4883" y2="138.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="128.5" y="130.5352">SendFileMachine</text><ellipse cx="52.5" cy="161.4883" fill="#000000" filter="url(#f1acyteumssvtb)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1acyteumssvtb)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="17" y="208.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="17" x2="88" y1="234.9766" y2="234.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="51" x="27" y="227.0234">Waiting</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="22" y="251.5781">[1,0]</text><rect fill="#FEFECE" filter="url(#f1acyteumssvtb)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="76" x="238.5" y="208.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="238.5" x2="314.5" y1="234.9766" y2="234.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="248.5" y="227.0234">Sending</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="243.5" y="251.5781">[0,1]</text><!--link *start*SendFileMachine to Waiting--><path d="M52.5,171.5691 C52.5,179.8019 52.5,191.8906 52.5,203.2421 " fill="none" id="*start*SendFileMachine-Waiting" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="52.5,208.3893,56.5,199.3893,52.5,203.3893,48.5,199.3893,52.5,208.3893" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Waiting to Waiting--><path d="M88.2532,225.7791 C98.2932,226.1386 106,228.875 106,233.9883 C106,238.1428 100.9123,240.7283 93.6192,241.7446 " fill="none" id="Waiting-Waiting" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="88.2532,242.1975,97.5578,245.4263,93.2355,241.7769,96.8848,237.4546,88.2532,242.1975" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Waiting to Sending--><path d="M88.2803,247.6636 C96.6778,250.2863 105.6792,252.6349 114.25,253.9883 C157.2725,260.7818 169.1893,260.5354 212.25,253.9883 C219.0607,252.9528 226.1429,251.3331 233.01,249.4534 " fill="none" id="Waiting-Sending" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="238.2114,247.9706,228.4596,246.5914,233.403,249.3414,230.6529,254.2848,238.2114,247.9706" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="115.25" y="250.5566">Recv Interested</text><!--link Sending to Waiting--><path d="M238.3508,233.9883 C198.1321,233.9883 134.9913,233.9883 93.6684,233.9883 " fill="none" id="Sending-Waiting" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="88.4895,233.9883,97.4895,237.9883,93.4895,233.9883,97.4895,229.9883,88.4895,233.9883" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="106.75" y="227.5566">Recv UnInterested</text><!--link Sending to Sending--><path d="M314.714,225.8108 C324.8346,226.2781 332.5,229.0039 332.5,233.9883 C332.5,238.0381 327.4397,240.5969 320.1135,241.6647 " fill="none" id="Sending-Sending" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="314.714,242.1658,324.0452,245.3168,319.6926,241.7036,323.3058,237.351,314.714,242.1658" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1acyteumssvtb)" height="370.4883" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="366" x="401" y="8"/><rect fill="#FFFFFF" height="338" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="360" x="404" y="37.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="401" x2="767" y1="34.4883" y2="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="528" y="26.5352">RecvFileMachine</text><ellipse cx="499" cy="57.4883" fill="#000000" filter="url(#f1acyteumssvtb)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1acyteumssvtb)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="462" y="104.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="462" x2="536" y1="130.9766" y2="130.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="472" y="123.0234">NoNeed</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="467" y="147.5781">[1,0]</text><rect fill="#FEFECE" filter="url(#f1acyteumssvtb)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="80" x="412" y="208.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="412" x2="492" y1="234.9766" y2="234.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="422" y="227.0234">Chocked</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="417" y="251.5781">[1,1]</text><rect fill="#FEFECE" filter="url(#f1acyteumssvtb)" height="50.6211" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="476.5" y="312.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="476.5" x2="549.5" y1="338.9766" y2="338.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="486.5" y="331.0234">Recving</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="481.5" y="355.5781">[0,1]</text><!--link *start*RecvFileMachine to NoNeed--><path d="M499,67.5691 C499,75.8019 499,87.8906 499,99.2421 " fill="none" id="*start*RecvFileMachine-NoNeed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="499,104.3893,503,95.3893,499,99.3893,495,95.3893,499,104.3893" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NoNeed to NoNeed--><path d="M536.0153,121.7887 C546.2097,122.1848 554,124.918 554,129.9883 C554,134.1872 548.6575,136.7832 541.0314,137.7766 " fill="none" id="NoNeed-NoNeed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="536.0153,138.1879,545.3122,141.4388,540.9986,137.7792,544.6582,133.4656,536.0153,138.1879" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NoNeed to Chocked--><path d="M461.8017,142.5989 C447.6796,149.4102 433.0667,159.3891 425,173.4883 C419.5018,183.0981 421.9556,194.0348 427.1588,203.9419 " fill="none" id="NoNeed-Chocked" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="429.7242,208.4129,428.7145,198.6159,427.2358,204.0761,421.7756,202.5974,429.7242,208.4129" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="426" y="187.0566">Bitfield &amp;&amp; have need</text><!--link Chocked to Chocked--><path d="M492.1186,224.3549 C502.3323,224.9881 510,228.1992 510,233.9883 C510,238.7824 504.7415,241.8085 497.1334,243.0667 " fill="none" id="Chocked-Chocked" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="492.1186,243.6217,501.504,246.6074,497.0883,243.0717,500.624,238.656,492.1186,243.6217" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Chocked to Recving--><path d="M466.1482,259.7403 C472.1629,270.5359 479.3185,283.1821 486,294.4883 C488.5776,298.8501 491.346,303.426 494.0923,307.9046 " fill="none" id="Chocked-Recving" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="496.8234,312.3391,495.5096,302.5782,494.2014,308.0817,488.6979,306.7735,496.8234,312.3391" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="487" y="291.0566">UnChocked</text><!--link Recving to Recving--><path d="M549.6788,328.2978 C559.7805,328.7659 567.5,331.9961 567.5,337.9883 C567.5,342.857 562.4039,345.9022 555.0746,347.1242 " fill="none" id="Recving-Recving" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="549.6788,347.6788,559.0407,350.7372,554.6526,347.1674,558.2225,342.7792,549.6788,347.6788" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="573.5" y="343.0566">Recv Piece &amp;&amp; have need</text><!--link Recving to NoNeed--><path d="M547.8476,312.288 C552.7881,306.9873 557.1504,301.0085 560,294.4883 C581.5362,245.2111 584.6263,221.2962 560,173.4883 C555.5272,164.805 548.4296,157.4729 540.6321,151.4466 " fill="none" id="Recving-NoNeed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="536.2403,148.2326,541.1408,156.7757,540.2752,151.1855,545.8654,150.3199,536.2403,148.2326" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="578" y="239.0566">No more need</text><!--
@startuml status
state SendFileMachine{
    [*] - -> Waiting
    Waiting -> Waiting
    Waiting: [1,0]
    Waiting-> Sending: Recv Interested
    Sending: [0,1]
    Sending-> Waiting: Recv UnInterested
    Sending -> Sending
}
state RecvFileMachine{
    [*] - -> NoNeed
    NoNeed - -> NoNeed
    NoNeed: [1,0]
    NoNeed - -> Chocked : Bitfield && have need
    Chocked: [1,1]
    Chocked - -> Chocked
    Recving: [0,1]
    Chocked - -> Recving : UnChocked
    Recving - -> Recving : Recv Piece && have need
    Recving - -> NoNeed : No more need
    
}
@enduml

PlantUML version 1.2018.03(Fri Apr 06 00:59:15 CST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 9.0.4+11
Operating System: Mac OS X
OS Version: 10.12.6
Default Encoding: UTF-8
Language: en
Country: CN
--></g></svg>